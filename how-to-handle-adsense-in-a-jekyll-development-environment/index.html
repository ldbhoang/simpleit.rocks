<!DOCTYPE html>
<html>
  
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="stylesheet" href="/css/main.css">
  <link rel="alternate" type="application/rss+xml" title="Simple IT ðŸ¤˜ Rocks" href="http://simpleit.rocks/feed.xml">

  <!-- jQuery -->
  <script src="/bower_components/jquery/dist/jquery.min.js"></script>

  <!-- Fontawesome -->
  <link rel="stylesheet" href="/bower_components/font-awesome/css/font-awesome.min.css" type="text/css" media="screen" />

  <!-- Bootstrap -->
  <link rel="stylesheet" type="text/css" href="/bower_components/bootstrap/dist/css/bootstrap.min.css">
  <script src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

  
  <!-- Begin Jekyll SEO tag v2.0.0 -->
<title>How To Handle Adsense In A Jekyll Development Environment - Simple IT ðŸ¤˜ Rocks</title>
<meta property="og:title" content="How To Handle Adsense In A Jekyll Development Environment" />
<meta name="description" content="Adsense ads should be treated in a special way when developing a website to avoid being penalized and improve performance." />
<meta property="og:description" content="Adsense ads should be treated in a special way when developing a website to avoid being penalized and improve performance." />
<link rel="canonical" href="http://simpleit.rocks/how-to-handle-adsense-in-a-jekyll-development-environment/" />
<meta property="og:url" content="http://simpleit.rocks/how-to-handle-adsense-in-a-jekyll-development-environment/" />
<meta property="og:site_name" content="Simple IT ðŸ¤˜ Rocks" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-06-06T00:00:00-03:00" />
<meta property="fb:app_id" content="1822851531277021" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "How To Handle Adsense In A Jekyll Development Environment",
    "datePublished": "2016-06-06T00:00:00-03:00",
    "description": "Adsense ads should be treated in a special way when developing a website to avoid being penalized and improve performance.",
    "url": "http://simpleit.rocks/how-to-handle-adsense-in-a-jekyll-development-environment/"
  }
</script>
<!-- End Jekyll SEO tag -->

  

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-1912030305535489",
    enable_page_level_ads: true
  });
</script>



</head>


  <body>

    

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-28572639-2', 'auto');
  ga('send', 'pageview');

</script>



    <header class="site-header">

  <!-- mermaid -->
  <script src="/bower_components/mermaid/dist/mermaid.min.js"></script>
  <script>mermaid.initialize({startOnLoad:true});</script>
  <!-- endmermaid -->

  <div class="wrapper">

    <a class="site-title" href="/">Simple IT ðŸ¤˜ Rocks</a>

  </div>

  <div class="jumbotron jumbotron-fluid bg-inverse">
    <div class="container">
      
      <h1 class="title">How To Handle Adsense In A Jekyll Development Environment</h1>
      
      <p class="lead">
	<small class="text-muted subtitle">Handle Adsense safely when developing.</small>
      </p>
    </div>
  </div>

</header>


    <div class="container">
      <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <p class="post-meta">
      
      <time datetime="2016-06-06T00:00:00-03:00" itemprop="datePublished">Jun 6, 2016</time>
      
      
      â€¢
      <span itemprop="author" itemscope itemtype="http://schema.org/Person">
	<span itemprop="name">marcanuy</span>
      </span>
      
    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <div class="row">
  <div class="col-md-3 col-md-push-9 sit-sidebar">
    <h4>Table of Contents</h4>
    
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#process">Process</a></li>
<li class="toc-entry toc-h2"><a href="#overview">Overview</a></li>
<li class="toc-entry toc-h2"><a href="#alternative-1-google-code-parameter-to-make-tests">Alternative 1: Google code parameter to make tests</a></li>
<li class="toc-entry toc-h2"><a href="#alternative-2-stop-showing-adsense-ads">Alternative 2: Stop showing adsense ads</a></li>
<li class="toc-entry toc-h2"><a href="#environment-in-jekyll-liquid-template">Environment in Jekyll liquid template</a></li>
<li class="toc-entry toc-h2"><a href="#graphical-summary-for-how-to-handle-adsense-in-a-jekyll-development-environment">Graphical summary for how to handle adsense in a jekyll development environment</a></li>
</ul>
    

    <div class="si-ad">
  

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- simpleit_side_content -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-1912030305535489"
       data-ad-slot="5882730780"
       data-ad-format="auto"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  
  
</div>


  </div>
  <div class="col-md-9 col-md-pull-3 sit-content">

    
    <p class="lead">
      Adsense ads should be treated in a special way when developing a website to avoid being penalized and improve performance.

    </p>
    

    <div class="si-ad">
  

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- simpleit_before_content -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-1912030305535489"
       data-ad-slot="2929264389"
       data-ad-format="auto"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

  
</div>


    <h2>Process</h2>
<div class="row">
  <div class="col-xl-6">
    
    <div>Current</div>
    <div class="mermaid">
      sequenceDiagram
    local->>local: webpage development loading starts
    local->>AdsenseServer: javascript request
    AdsenseServer-->>local: adsense code
    local->>local: webpage ready
    local->>AdsenseServer: accidental clicks

    </div>
    
  </div>
  <div class="col-xl-6">
    
    <div>Goal</div>
    <div class="mermaid">
      sequenceDiagram
    local->>local: webpage development loading starts
    local->>local: webpage ready

    </div>
    
  </div>
</div>
<div class="si-tutorial-overview">
  
</div>

<h2 id="overview">Overview</h2>

<p>Developing a site that uses Google Adsense has to be treated carefully. 
Developers often want to stop showing</p>

<p>It presents the following problems:</p>

<ul>
  <li><strong>accidental clicks</strong>. Avoid <em>repeatedly accidentally clicking</em> on served ads while 
developing the site which can lead to an account ban.</li>
</ul>

<blockquote cite="https://support.google.com/adsense/answer/1348754?hl=en#q1">
  <p>Although publishers are not permitted to click on their own ads for any
reason, we do understand that accidental clicks may occur. We therefore
donâ€™t require that you contact us every time you click on your ads. Rest
assured that your account is being properly credited for all clicks and
impressions we consider to be valid.</p>
</blockquote>

<ul>
  <li><strong>speed</strong>. Testing the site locally without waiting for each ad request 
to resolve, avoiding any javascript external request.</li>
</ul>

<p>There are two main options to avoid these problems:</p>

<ul>
  <li>telling Google that the <em>ad</em> request is only for testing purposes</li>
  <li>avoid the javascript request at all</li>
</ul>

<h2 id="alternative-1-google-code-parameter-to-make-tests">Alternative 1: Google code parameter to make tests</h2>

<p>There is a special parameter that can be enabled in Google Ad code to
avoid accidental clicks and set them up as tests.</p>

<p>The downside of this approach is that it requires
<a href="https://developers.google.com/custom-search-ads/docs/reference">more checks</a>
to modify an <em>ad</em> code and if not enabled in production, <strong>ads clicks wonâ€™t
generate any revenue</strong>.</p>

<blockquote cite="https://developers.google.com/custom-search-ads/docs/reference">
  <p>To use this code you must have an AdSense account
with active permission to use AdSense Custom Search Ads.</p>
</blockquote>

<p>The parameter is <code class="highlighter-rouge">'adtest' : 'on'</code> and it is defined:</p>

<blockquote cite="https://developers.google.com/custom-search-ads/docs/reference#page-level-parameter-descriptions">
  <p>The adtest parameter is used to indicate that a request for ads is a test. 
When the adtest parameter has a value of on, Google treats the request as
a test and does not count the ad impressions or track the clickthrough results.</p>
</blockquote>

<p>An <em>easier</em> and <em>safer</em> alternative is to avoid the ad request at all.</p>

<h2 id="alternative-2-stop-showing-adsense-ads">Alternative 2: Stop showing adsense ads</h2>

<p>Jekyll templates can access the value of an environment variable passed
at build time to avoid any external javascript request. Based on this
variable the ads can be chosen to be shown or hidden depending on its value.</p>

<p>When building the site with <code class="highlighter-rouge">jekyll build</code> the variable
<a href="https://jekyllrb.com/docs/configuration/#specifying-a-jekyll-environment-at-build-time">JEKYLL_ENV</a> 
defaults to <em>development</em>, setting it up as <em>production</em> makes it
possible to hide the ads in liquid templates</p>

<p>To build a production ready jekyll site it can be specified like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span><span class="nv">JEKYLL_ENV</span><span class="o">=</span>production jekyll build
</code></pre>
</div>

<p>When using a [Bundler command]
it should be used like:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span><span class="nv">JEKYLL_ENV</span><span class="o">=</span>production bundle <span class="nb">exec </span>jekyll build
</code></pre>
</div>

<h2 id="environment-in-jekyll-liquid-template">Environment in Jekyll liquid template</h2>

<p>The environment can be accessed through the variable <code class="highlighter-rouge">jekyll.environment</code>.</p>

<p>The Adsense ad code provided by Google can be surrounded with the
environment detection so they only gets loaded in production like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{%</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="nv">jekyll</span><span class="p">.</span><span class="nv">environment</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"production"</span><span class="w"> </span><span class="p">%}</span>
  &lt;script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"&gt;&lt;/script&gt;
  &lt;!-- simpleit_after_content --&gt;
  &lt;ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-****************"
       data-ad-slot="***********"
       data-ad-format="auto"&gt;&lt;/ins&gt;
  &lt;script&gt;
    (adsbygoogle = window.adsbygoogle || []).push({});
  &lt;/script&gt;
<span class="p">{%</span><span class="w"> </span><span class="kr">endif</span><span class="w"> </span><span class="p">%}</span>
</code></pre>
</div>

<p>A good practice is also to include something locally when not
showing them, to quickly identify ads placement, it can be:</p>

<ul>
  <li>text with some color different from the rest of the site design</li>
  <li>a <a href="http://placehold.it/">placeholder</a></li>
  <li>an image like the ad from <a href="https://support.google.com/adsense/answer/185666?hl=en">example ads</a></li>
</ul>




<div class="">
  <div class="">
    <h2>Graphical summary for how to handle adsense in a jekyll development environment</h2>
    <div class="mermaid text-sm-center">
      graph LR
  template["Avoid Adsense code in templates <br > in development environment"];
  template ==> build{"build the site with <br> JEKYLL_ENV"};
  build ==>|development| development["if JEKYLL_ENV is 'development' <br> it won't load ads"]
  build ==>|production| production["if JEKYLL_ENV is 'production' it will load and display ads"]

    </div>  
  </div>
</div>


    
  </div>
</div>


Categories: 

<span class="entry-categories">
  docs
</span>

,


<span class="entry-categories">
  ruby
</span>

,


<span class="entry-categories">
  jekyll
</span>

,


<span class="entry-categories">
  tutorials
</span>




<div class="row">
  <div class="col-md-6">
    <div class="post-comments">
  

  <div id="disqus_thread"></div>
  <script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
    */
    /*
    var disqus_config = function () {
    this.page.url = '/how-to-handle-adsense-in-a-jekyll-development-environment/';  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = 'simpleitrocks'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    
    s.src = '//simpleitrocks.disqus.com/embed.js';
    
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  
  
  
</div>

  </div>
  <div class="col-md-6">
    <div class="si-ad">
  

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- simpleit_after_content -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-1912030305535489"
       data-ad-slot="5104001581"
       data-ad-format="auto"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

  
</div>

  </div>
</div>


  </div>

</article>

    </div>

    <footer class="site-footer">

  <div class="container">

    <h2 class="footer-heading text-muted">Simple IT ðŸ¤˜ Rocks</h2>

    <div class="row">
      <div class="col-xs-6">
        <ul class="contact-list">
          <li>
	    <i class="fa fa-keyboard-o" aria-hidden="true"></i>Coded by Marcelo Canina
	  </li>
	  
          <li>
            <i class="fa fa-twitter" aria-hidden="true"></i><a href="https://twitter.com/marcanuy"><span class="username">marcanuy</span></a>

          </li>
          
	  <li>
	    <i class="fa fa-user" aria-hidden="true"></i><a href="/about">About</a>
	  </li>
        </ul>
      </div>

      <div class="col-xs-6">
	<div class="text-xs-right text-muted">
          <p>Clutter-free software concepts. Written on the go.
</p>
	</div>
      </div>
    </div>

  </div>
</footer>

<div class="si-license">
  <div class="text-muted text-sm-center">
    <small>
      Except as otherwise noted, the content of this page is licensed under
      <a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/">
	<i class="fa fa-creative-commons" aria-hidden="true"></i> BY-NC 4.0
      </a>
    </small>
  </div>
</div>



  </body>

</html>
